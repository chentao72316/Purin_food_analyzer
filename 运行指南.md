# 运行指南

## 前置要求

- Node.js 18.0 或更高版本
- npm、yarn 或 pnpm 包管理器

## 快速开始

### 步骤 1：安装依赖

在项目根目录打开终端，运行：

```bash
npm install
```

或者使用 yarn：
```bash
yarn install
```

或者使用 pnpm：
```bash
pnpm install
```

### 步骤 2：配置环境变量

在项目根目录创建 `.env.local` 文件，内容如下：

```env
ARK_API_KEY=d3c412ec-e817-415d-b896-6803f29a639a
ARK_ENDPOINT_ID=ep-20251214002916-lthkj
ARK_API_URL=https://ark.cn-beijing.volces.com/api/v3/responses
```

**注意**：`.env.local` 文件已经在 `.gitignore` 中，不会被提交到版本控制。

### 步骤 3：启动开发服务器

运行以下命令：

```bash
npm run dev
```

或者：
```bash
yarn dev
```

或者：
```bash
pnpm dev
```

### 步骤 4：访问应用

打开浏览器，访问：
```
http://localhost:3000
```

## 详细步骤说明

### Windows 系统

1. **打开 PowerShell 或 CMD**
   - 在项目文件夹中，按住 `Shift` 键，右键点击空白处
   - 选择"在此处打开 PowerShell 窗口"或"在此处打开命令窗口"

2. **检查 Node.js 版本**
   ```bash
   node --version
   ```
   应该显示 v18.0.0 或更高版本

3. **安装依赖**
   ```bash
   npm install
   ```
   等待安装完成（可能需要几分钟）

4. **创建环境变量文件**
   - 在项目根目录创建 `.env.local` 文件
   - 可以使用记事本或任何文本编辑器
   - 复制上面的环境变量内容

5. **启动服务器**
   ```bash
   npm run dev
   ```

6. **查看输出**
   应该看到类似以下输出：
   ```
   ▲ Next.js 14.x.x
   - Local:        http://localhost:3000
   - Ready in X.Xs
   ```

### macOS / Linux 系统

1. **打开终端**
   ```bash
   cd /path/to/purin-food-analyzer
   ```

2. **检查 Node.js**
   ```bash
   node --version
   ```

3. **安装依赖**
   ```bash
   npm install
   ```

4. **创建环境变量文件**
   ```bash
   touch .env.local
   nano .env.local
   ```
   然后粘贴环境变量内容，按 `Ctrl+X` 保存

5. **启动服务器**
   ```bash
   npm run dev
   ```

## 使用应用

1. **上传图片**
   - 点击上传区域选择文件
   - 或拖拽图片到上传区域
   - 或点击"拍照"按钮（移动端）

2. **开始识别**
   - 上传图片后，点击"开始识别"按钮
   - 等待AI分析（通常需要几秒到十几秒）

3. **查看结果**
   - 图片上会显示标注框
   - 下方会显示详细的食物信息

## 常见问题

### 问题1：找不到模块错误

**错误信息**：`Cannot find module 'xxx'`

**解决方法**：
```bash
# 删除 node_modules 和 package-lock.json，重新安装
rm -rf node_modules package-lock.json
npm install
```

Windows 系统：
```powershell
Remove-Item -Recurse -Force node_modules, package-lock.json
npm install
```

### 问题2：端口被占用

**错误信息**：`Port 3000 is already in use`

**解决方法**：
- 关闭占用 3000 端口的其他程序
- 或使用其他端口：
  ```bash
  npm run dev -- -p 3001
  ```

### 问题3：环境变量未生效

**解决方法**：
- 确保 `.env.local` 文件在项目根目录
- 确保文件内容格式正确（没有多余的空格）
- 重启开发服务器

### 问题4：API 调用失败

**可能原因**：
- API 密钥无效
- 网络连接问题
- API 服务不可用

**解决方法**：
- 检查 `.env.local` 中的 API 配置
- 检查网络连接
- 查看浏览器控制台的错误信息

### 问题5：TypeScript 类型错误

**解决方法**：
```bash
# 重新安装类型定义
npm install --save-dev @types/node @types/react @types/react-dom
```

## 生产环境部署

### 构建生产版本

```bash
npm run build
```

### 启动生产服务器

```bash
npm start
```

### 部署到 Vercel

1. 将代码推送到 GitHub
2. 在 Vercel 中导入项目
3. 在 Vercel 项目设置中添加环境变量
4. 部署

## 开发命令

- `npm run dev` - 启动开发服务器
- `npm run build` - 构建生产版本
- `npm start` - 启动生产服务器
- `npm run lint` - 运行代码检查

## 获取帮助

如果遇到问题：
1. 查看浏览器控制台的错误信息
2. 查看终端输出的错误信息
3. 检查 README.md 和 USAGE.md 文档
4. 确认所有依赖都已正确安装

